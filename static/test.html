<!DOCTYPE html>
<html>
<head>
    <title>Simple Dashboard Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .status { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .loading { background: #fff3cd; color: #856404; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üçØ DDoSPoT Dashboard Test</h1>
    
    <div id="status" class="status loading">Loading dashboard data...</div>
    <div id="output"></div>

    <script>
        async function testDashboard() {
            const statusDiv = document.getElementById('status');
            const outputDiv = document.getElementById('output');
            let html = '';
            
            try {
                // Test 1: Health Check
                console.log('Testing health endpoint...');
                const healthResp = await fetch('http://127.0.0.1:5000/health');
                const health = await healthResp.json();
                html += `<div class="status success">‚úì Health: ${health.status}</div>`;
                
                // Test 2: Stats
                console.log('Testing stats endpoint...');
                const statsResp = await fetch('http://127.0.0.1:5000/api/stats?hours=24');
                const stats = await statsResp.json();
                html += `<div class="status success">‚úì Stats Retrieved</div>`;
                html += `<pre>${JSON.stringify(stats, null, 2)}</pre>`;
                
                // Test 3: Top Attackers
                console.log('Testing top attackers...');
                const attackersResp = await fetch('http://127.0.0.1:5000/api/top-attackers?limit=5');
                const attackers = await attackersResp.json();
                html += `<div class="status success">‚úì Top Attackers: ${attackers.length} found</div>`;
                html += `<pre>${JSON.stringify(attackers, null, 2)}</pre>`;
                
                statusDiv.className = 'status success';
                statusDiv.textContent = '‚úì All tests passed! Dashboard is working.';
                
            } catch (error) {
                console.error('Error:', error);
                statusDiv.className = 'status error';
                statusDiv.textContent = '‚úó Error: ' + error.message;
                html += `<pre style="color: red;">${error.stack}</pre>`;
            }
            
            outputDiv.innerHTML = html;
        }
        
        // Run when page loads
        window.addEventListener('load', testDashboard);
        
        // Also run immediately
        testDashboard();
    </script>
</body>
</html>
