# Incident Response: From Detection to Resolution

## Overview

Incident response is the process of handling security incidents detected by DDoSPoT, from initial alert through resolution and post-mortem analysis.

---

## Incident Response Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. DETECTION & ALERTING                     â”‚
â”‚ DDoSPoT detects threat, sends alert        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. INITIAL RESPONSE                         â”‚
â”‚ Security team acknowledges and gathers info â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. ANALYSIS & INVESTIGATION                 â”‚
â”‚ Determine scope, severity, and impact       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. CONTAINMENT                              â”‚
â”‚ Stop the attack, prevent spread             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. ERADICATION                              â”‚
â”‚ Remove attacker access and malware          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6. RECOVERY                                 â”‚
â”‚ Restore systems to normal operation         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 7. POST-INCIDENT ANALYSIS                   â”‚
â”‚ Learn and improve defenses                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 1: Detection & Alerting

### DDoSPoT Detects Threat

```
Alert Triggered:
â”œâ”€ Threat Score: 0.87 (HIGH)
â”œâ”€ Attack Type: SSH Brute Force
â”œâ”€ Source IP: 203.0.113.45
â”œâ”€ Time: 2024-01-15 14:30:00 UTC
â”œâ”€ Duration: 120 seconds
â”œâ”€ Attempts: 15
â””â”€ Response: IP Blocked
```

### Alert Channels

```
Email Alert:
To: security-team@company.com
Subject: HIGH - SSH Brute Force Attack from 203.0.113.45
[Full alert details]

Slack Alert:
Channel: #security-alerts
Message: ğŸš¨ HIGH SSH Brute Force from 203.0.113.45
[Link to dashboard]

PagerDuty:
Incident: SSH Brute Force Attack
Severity: High
Assigned: On-call engineer
Auto-escalate: 15 minutes
```

---

## Phase 2: Initial Response

### Receipt & Acknowledgment

```
Timeline:

14:30:01 UTC
  Alert generated by DDoSPoT
  Threat Score: 0.87

14:30:15 UTC
  Alert delivered via all channels
  Email sent
  Slack notification
  PagerDuty incident created

14:30:45 UTC
  Security team receives alert
  On-call engineer acknowledges
  Status: ACTIVE

14:31:00 UTC
  Initial information:
  â”œâ”€ What: SSH Brute Force
  â”œâ”€ When: Just started (30 seconds)
  â”œâ”€ Who: 203.0.113.45 (China)
  â”œâ”€ Where: Your honeypot
  â””â”€ Status: Ongoing
```

### Initial Assessment

```
Quick Questions:

1. Is this real? YES (High threat score, clear pattern)
2. Should we escalate? YES (Automated response already taken)
3. Do we need to isolate? NO (Honeypot is isolated)
4. Is production at risk? NO (Honeypot, not real systems)
5. What's the urgency? MEDIUM (Automated, but monitor)

Action: Move to Phase 3 (Analysis)
```

---

## Phase 3: Analysis & Investigation

### Gather Intelligence

```
From DDoSPoT Dashboard:

Attack Details:
â”œâ”€ Source IP: 203.0.113.45
â”œâ”€ Port: 2222 (SSH honeypot)
â”œâ”€ Attack Type: Brute Force
â”œâ”€ Attempts: 15 in 2 minutes
â”œâ”€ Usernames: root, admin, test
â”œâ”€ Passwords: password, 123456, admin
â”œâ”€ Success: 0 attempts successful
â””â”€ Detection Time: 2 seconds from first attempt

Threat Intelligence:
â”œâ”€ Country: China (Jiangsu Province)
â”œâ”€ ISP: Alibaba Cloud
â”œâ”€ IP Reputation: 45/100 (Medium)
â”œâ”€ Previous Attacks: 23 from this IP
â”œâ”€ Days Since Last: 5 days
â”œâ”€ Blocklists:
â”‚  â”œâ”€ AbuseIPDB: 25 reports
â”‚  â”œâ”€ Spamhaus: Listed
â”‚  â””â”€ Project Honey Pot: 150 attacks
â””â”€ Risk: Known attacker
```

### Historical Analysis

```
Timeline of This IP:

Last 30 Days:
â”œâ”€ 2024-01-10: SSH attack (5 attempts)
â”œâ”€ 2024-01-12: HTTP attack (20 requests)
â”œâ”€ 2024-01-13: SSDP scan (100 requests)
â”œâ”€ 2024-01-15: SSH attack (15 attempts) â† Current

Pattern:
â”œâ”€ Frequency: Every 2-3 days
â”œâ”€ Time: Off-peak hours (02:00 UTC)
â”œâ”€ Focus: Credential attacks
â”œâ”€ Persistence: Long-term attacker

Conclusion: Known, targeted threat
```

### Impact Assessment

```
Questions:

Was Real Data Compromised? NO
  â””â”€ Honeypot, no real data

Were Real Systems Affected? NO
  â””â”€ Network isolated

Did Attack Succeed? NO
  â””â”€ 0 successful logins

Did Attacker Learn Anything? NO
  â””â”€ False responses recorded

What Did We Learn? YES
  â””â”€ Attacker tactics, timing, targets

Severity: LOW-MEDIUM (Information gathering only)
Impact: NONE (Honeypot functions as designed)
Escalation: Not needed (automatic response sufficient)
```

---

## Phase 4: Containment

### Immediate Actions

```
Already Taken by DDoSPoT:

âœ… IP Blocked (203.0.113.45)
   â”œâ”€ Application level
   â”œâ”€ Firewall level
   â””â”€ Duration: 1 hour (auto-unblock at 15:30:00)

âœ… Connection Terminated
   â””â”€ Attacker disconnected

âœ… Attack Logged
   â””â”€ Full details stored for analysis

âœ… Alert Generated
   â””â”€ Security team notified

Status: CONTAINED
```

### Additional Containment Steps

```
If Escalation Needed (not in this case):

1. Block at ISP level
   â””â”€ Contact ISP abuse team
   â””â”€ Request IP block

2. Block at network perimeter
   â””â”€ Add to enterprise firewall
   â””â”€ All traffic from IP dropped

3. Monitor for lateral movement
   â””â”€ Watch other IPs from same ASN
   â””â”€ Check for coordinated attacks

4. Implement temporary measures
   â””â”€ Change SSH port (not necessary for honeypot)
   â””â”€ Increase authentication requirements
```

---

## Phase 5: Eradication

### Check for Compromise

```
Questions to Answer:

Did Attacker Gain Access? NO
  â””â”€ 0 successful logins
  â””â”€ No shell provided
  â””â”€ No access to honeypot

Did Attacker Leave Backdoors? NO
  â””â”€ Honeypot read-only (can't write files)
  â””â”€ No privilege escalation occurred
  â””â”€ No rootkit installation

Did Attacker Steal Data? NO
  â””â”€ Honeypot has no real data
  â””â”€ Fake responses provided
  â””â”€ Attacker doesn't know it's fake

Eradication Steps Needed: NONE
  â””â”€ No compromise to remediate
```

### Verification

```
Post-Containment Checklist:

âœ“ No ongoing attack
âœ“ No attacker access
âœ“ No malware present
âœ“ No backdoors installed
âœ“ No data exfiltration
âœ“ Systems functioning normally

Status: ERADICATED (nothing to eradicate)
```

---

## Phase 6: Recovery

### Restore Operations

```
DDoSPoT Status: Already running normally
â”œâ”€ Honeypots: All operational
â”œâ”€ Detection: Running
â”œâ”€ Response: Active
â””â”€ Monitoring: Continuous

No Recovery Needed:
â””â”€ Never was compromised
â””â”€ Continued operating during attack
â””â”€ Automatic unblock at scheduled time
```

### Unblock Decision

```
Automatic Unblock:
â”œâ”€ Time: 15:30:00 UTC (1 hour from block)
â”œâ”€ Reason: Default policy
â”œâ”€ Monitoring: Continue 7 days

Manual Unblock: NO
â”œâ”€ Reason: No need to hurry
â”œâ”€ Let automatic policy stand
â””â”€ Monitor for new attacks

Extended Monitoring:
â”œâ”€ Watch for same IP
â”œâ”€ Watch for similar IPs (same ASN)
â”œâ”€ Check for new attack types
â””â”€ Duration: 7 days
```

---

## Phase 7: Post-Incident Analysis

### Create Incident Report

```
INCIDENT REPORT #2024-001234

Date: 2024-01-15
Duration: 2 minutes (14:30:00 - 14:32:00 UTC)
Severity: MEDIUM
Impact: NONE

Summary:
SSH brute force attack from 203.0.113.45 detected and
automatically blocked by DDoSPoT. No compromise occurred.

Attack Details:
â”œâ”€ Type: SSH Brute Force
â”œâ”€ Source: 203.0.113.45 (Alibaba Cloud, China)
â”œâ”€ Target: SSH honeypot (port 2222)
â”œâ”€ Duration: 2 minutes
â”œâ”€ Attempts: 15
â”œâ”€ Success: 0
â””â”€ First Response: 2 seconds

Timeline:
14:30:00 - Attack begins
14:30:02 - DDoSPoT detects threat
14:30:05 - IP blocked automatically
14:30:15 - Alert to security team
14:30:45 - Team acknowledges
14:32:00 - Attack stops (attacker gives up)

Response:
âœ“ DDoSPoT automatic response
âœ“ IP blocked (1 hour)
âœ“ Alert generated
âœ“ Security team notified
âœ“ No additional action needed

Lessons Learned:
1. Automatic response effective
2. Detection time excellent (2 seconds)
3. Threat intelligence helpful (knew IP history)
4. No false positives (attack was real)
5. Documentation process works

Recommendations:
1. Continue current settings (working well)
2. Monitor this IP long-term
3. Share intelligence with threat feed
4. Increase monitoring of similar IPs
5. Annual security review (pass)

Sign-off:
Security Manager: John Doe
Date: 2024-01-15 16:00 UTC
Status: CLOSED
```

### Metrics & Statistics

```
Incident Metrics:

Detection Speed: 2 seconds
â”œâ”€ Industry average: 5-10 minutes
â”œâ”€ DDoSPoT: 2 seconds
â””â”€ Rating: EXCELLENT

Response Speed: 5 seconds (automatic)
â”œâ”€ Human response: 15 seconds
â”œâ”€ Total: 20 seconds
â””â”€ Rating: EXCELLENT

Impact: NONE
â”œâ”€ No data compromised
â”œâ”€ No systems affected
â”œâ”€ No downtime
â””â”€ Rating: EXCELLENT

False Positive Rate: 0%
â”œâ”€ Attack was real
â”œâ”€ Response was appropriate
â”œâ”€ No unnecessary actions
â””â”€ Rating: EXCELLENT

Overall Incident Rating: WELL HANDLED
```

### Improvements

```
Action Items:

1. Threat Intelligence Sharing
   â””â”€ Share attack details with industry
   â””â”€ Add to threat feed
   â””â”€ Help others

2. Long-term Monitoring
   â””â”€ Add IP to watchlist
   â””â”€ Monitor ASN for similar attacks
   â””â”€ Track trends

3. Documentation
   â””â”€ Incident documented
   â””â”€ Process validated
   â””â”€ Team trained

4. Process Improvements
   â””â”€ Detection: EXCELLENT (no changes)
   â””â”€ Response: EXCELLENT (no changes)
   â””â”€ Analysis: GOOD (documented well)
   â””â”€ Escalation: N/A (handled automatically)

Status: All items completed
```

---

## Different Scenarios

### Scenario 2: Critical Attack

```
What If: Attacker had gained access?

Different Timeline:

14:30:00 - Attack detected
14:30:02 - Threat score: 0.95 (CRITICAL)
14:30:05 - IP blocked at all levels
14:30:15 - Alert escalated to CRITICAL
14:30:20 - All-hands alert sent
14:30:30 - Security team assembles
14:30:45 - Incident commander assigned
14:31:00 - Communication plan activated
14:31:15 - Forensics team engaged
14:32:00 - Investigation begins
...

Phase 3 (Analysis) becomes much longer
Phase 5 (Eradication) requires cleanup
Investigation: Days to weeks
```

### Scenario 3: Widespread Attack

```
What If: Multiple IPs, coordinated attack?

Response:

14:30:00 - Attack detected from IP 1
14:30:02 - Detection continues
14:30:05 - 5 more IPs detected (same pattern)
14:30:10 - Escalation: Coordinated attack
14:30:15 - Block all 6 IPs
14:30:20 - CRITICAL alert
14:30:30 - DDoS deflection activated
14:30:45 - Incident commander called
...

DDoSPoT handles:
â”œâ”€ Automatic detection of pattern
â”œâ”€ Automatic blocking of all IPs
â”œâ”€ Alert severity escalation
â”œâ”€ Intelligent response
```

---

## Best Practices

### 1. Preparation

```
Before Incidents:

Preparation:
â”œâ”€ Define incident response plan
â”œâ”€ Assign roles and responsibilities
â”œâ”€ Create playbooks for common scenarios
â”œâ”€ Train team regularly
â”œâ”€ Test the process quarterly
â””â”€ Keep contact lists updated

Documentation:
â”œâ”€ Response procedures
â”œâ”€ Escalation paths
â”œâ”€ Contact information
â”œâ”€ Communication templates
â””â”€ Post-incident checklist
```

### 2. Communication

```
During Incident:

Communication:
â”œâ”€ First: Team notification
â”œâ”€ Second: Management notification
â”œâ”€ Third: Affected parties notification
â”œâ”€ Fourth: External stakeholders (if needed)
â”œâ”€ Ongoing: Status updates every 30 minutes
â””â”€ Final: Post-incident summary

Templates:
â”œâ”€ "We detected [ATTACK] at [TIME]"
â”œâ”€ "Current status: [STATUS]"
â”œâ”€ "Estimated resolution: [TIME]"
â””â”€ "No customer data compromised"
```

### 3. Documentation

```
During & After:

Document:
â”œâ”€ When incident detected
â”œâ”€ What was detected
â”œâ”€ Who responded
â”œâ”€ Where it happened
â”œâ”€ Why it happened
â””â”€ How it was resolved

Storage:
â”œâ”€ Incident management system
â”œâ”€ Version controlled
â”œâ”€ Access restricted
â””â”€ Retained: 7 years
```

---

## Key Takeaways

1. **Detection**: DDoSPoT detects threats in seconds
2. **Automation**: Automatic response to known patterns
3. **Investigation**: Thorough analysis of each incident
4. **Documentation**: Detailed records for learning
5. **Improvement**: Process improves with each incident

---

## Next Steps

- **Setup**: [Setting Up DDoSPoT](08_Setting_Up_DDoSPoT.md)
- **Monitoring**: [Monitoring Threats](09_Monitoring_Threats.md)
- **Response**: [Automated Response](07_Automated_Response.md)
- **Case Studies**: [Case Studies](16_Case_Studies.md)

---

## Review Questions

1. What are the 7 phases of incident response?
2. What should be included in an incident report?
3. How would you communicate during a critical incident?
4. What metrics indicate good incident response?
5. How would you prepare for incidents in advance?

## Additional Resources

- NIST Incident Response Guide
- SANS Incident Response Process
- CIS Incident Response Controls
- Incident Command System (ICS)
